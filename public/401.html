<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>401 Unauthorized - ChatCompletions</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
</head>

<body class="bg-gray-50 min-h-screen">
    <!-- Navigation -->
    <nav class="fixed w-full bg-white bg-opacity-90 backdrop-blur-sm z-50 border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex-shrink-0 flex items-center">
                    <a href="/" class="text-2xl font-bold text-gray-900">chatcompletions</a>
                </div>
                <div class="hidden md:ml-6 md:flex md:items-center md:space-x-4">
                    <a href="/" class="text-gray-700 hover:text-gray-900 px-3 py-2">Home</a>
                    <a href="/docs" class="text-gray-700 hover:text-gray-900 px-3 py-2">Docs</a>
                    <a href="https://github.com/codefromanywhere/chatcompletions"
                        class="text-gray-700 hover:text-gray-900 px-3 py-2">GitHub</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 pb-16">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Error Message -->
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">401 Unauthorized</h1>
                <p class="text-lg text-gray-600">Please provide valid authentication credentials to continue.</p>
            </div>

            <!-- Form -->
            <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                <form id="authForm" class="space-y-6">
                    <!-- Provider Selection -->
                    <div>
                        <label for="providerSelect" class="block text-sm font-medium text-gray-700">Provider</label>
                        <select id="providerSelect"
                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 rounded-md">
                            <option value="">Select a provider</option>
                        </select>
                    </div>

                    <!-- Model Selection -->
                    <div>
                        <label for="model" class="block text-sm font-medium text-gray-700">Model</label>
                        <input type="text" id="model" name="model" required
                            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <!-- Base Path -->
                    <div>
                        <label for="basePath" class="block text-sm font-medium text-gray-700">Base Path</label>
                        <input type="text" id="basePath" name="basePath" required
                            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                    </div>

                    <!-- API Key -->
                    <div>
                        <label for="apiKey" class="block text-sm font-medium text-gray-700">API Key</label>
                        <input type="password" id="apiKey" name="apiKey"
                            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                        <a id="getKeyLink" href="#" target="_blank"
                            class="hidden mt-2 text-sm text-indigo-600 hover:text-indigo-500">
                            Get a key for <span id="providerName"></span>
                        </a>
                    </div>

                    <!-- Context URL -->
                    <div>
                        <label for="contextUrl" class="block text-sm font-medium text-gray-700">Context URL</label>
                        <input type="url" id="contextUrl" name="contextUrl" required
                            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"
                            value="https://raw.githubusercontent.com/CodeFromAnywhere/chatcompletions/refs/heads/main/public/generate-website-system-prompt.md">
                    </div>

                    <!-- Prompt -->
                    <div>
                        <label for="prompt" class="block text-sm font-medium text-gray-700">Prompt</label>
                        <textarea id="prompt" name="prompt" rows="3" required
                            class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">A website with infinite scroll with catgifs using some api</textarea>
                    </div>

                    <!-- Extension -->
                    <div>
                        <label for="ext" class="block text-sm font-medium text-gray-700">Output Format</label>
                        <select id="ext" name="ext" required
                            class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 rounded-md">
                            <option value="html">HTML</option>
                            <option value="json">JSON</option>
                            <option value="yaml">YAML</option>
                            <option value="csv">CSV</option>
                            <option value="xml">XML</option>
                            <option value="md">Markdown</option>
                        </select>
                    </div>

                    <!-- Terms Acceptance -->
                    <div class="relative flex items-start">
                        <div class="flex items-center h-5">
                            <input id="terms" name="terms" type="checkbox" required
                                class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded">
                        </div>
                        <div class="ml-3 text-sm">
                            <label for="terms" class="font-medium text-gray-700">I accept the</label>
                            <a href="/tos.html" target="_blank" class="text-indigo-600 hover:text-indigo-500"> Terms of
                                Service</a>,
                            <a href="/privacy.html" target="_blank"
                                class="text-indigo-600 hover:text-indigo-500">Privacy Policy</a>
                            and required cookies
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div>
                        <button type="submit"
                            class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            Continue
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script>
        // Fetch providers data and initialize form
        async function initializeForm() {
            try {
                const response = await fetch('/providers.json');
                const providers = await response.json();

                const providerSelect = document.getElementById('providerSelect');
                const modelInput = document.getElementById('model');
                const basePathInput = document.getElementById('basePath');
                const getKeyLink = document.getElementById('getKeyLink');
                const providerNameSpan = document.getElementById('providerName');

                // Populate provider select
                Object.entries(providers).forEach(([provider, data]) => {
                    const option = document.createElement('option');
                    option.value = provider;
                    option.textContent = provider.charAt(0).toUpperCase() + provider.slice(1);
                    providerSelect.appendChild(option);
                });

                // Handle provider selection
                providerSelect.addEventListener('change', (e) => {
                    const selectedProvider = providers[e.target.value];
                    if (selectedProvider) {
                        basePathInput.value = selectedProvider.basePath;

                        // Show "Get Key" link
                        getKeyLink.href = selectedProvider.apiKeyUrl;
                        providerNameSpan.textContent = e.target.value;
                        getKeyLink.classList.remove('hidden');

                        // Populate model datalist
                        const modelOptions = selectedProvider.models.map(model => model.id);
                        modelInput.value = modelOptions[0] || '';
                    } else {
                        basePathInput.value = '';
                        getKeyLink.classList.add('hidden');
                    }
                });
            } catch (error) {
                console.error('Error fetching providers:', error);
            }
        }

        // Parse URL parameters on load
        function parseUrlParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const pathSegments = window.location.pathname.split('/');

            // Find indices in the URL structure
            const fromIndex = pathSegments.indexOf('from') + 1;
            const baseIndex = pathSegments.indexOf('base') + 1;
            const modelIndex = pathSegments.indexOf('model') + 1;
            const promptIndex = pathSegments.indexOf('prompt') + 1;

            if (fromIndex > 0) document.getElementById('contextUrl').value = decodeURIComponent(pathSegments[fromIndex]);
            if (baseIndex > 0) document.getElementById('basePath').value = decodeURIComponent(pathSegments[baseIndex]);
            if (modelIndex > 0) document.getElementById('model').value = decodeURIComponent(pathSegments[modelIndex]);
            if (promptIndex > 0) document.getElementById('prompt').value = decodeURIComponent(pathSegments[promptIndex]);

            // Get extension from the last segment
            const lastSegment = pathSegments[pathSegments.length - 1];
            if (lastSegment) {
                const ext = lastSegment.split('.')[1];
                if (ext) document.getElementById('ext').value = ext;
            }
        }

        // Handle form submission
        document.getElementById('authForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const formData = new FormData(e.target);
            const url = `/from/${encodeURIComponent(formData.get('contextUrl'))}/base/${encodeURIComponent(formData.get('basePath'))}/model/${encodeURIComponent(formData.get('model'))}/prompt/${encodeURIComponent(formData.get('prompt'))}/codeblock.${formData.get('ext')}`;

            window.location.href = url;
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializeForm();
            parseUrlParameters();
        });
    </script>
</body>

</html>